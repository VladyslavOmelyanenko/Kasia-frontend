---
import Layout from "../layouts/Layout.astro";
import { client } from "../lib/sanity";
import { toHTML } from "@portabletext/to-html";
import { urlFor } from "../lib/sanity";

const about = await client.fetch(`
  *[_type == "about"][0]{
    bio,
    email
  }
`);

const bioHtml = about?.bio
  ? toHTML(about.bio, {
      components: {
        types: {
          image: ({ value }) => {
            const src = value?.asset ? urlFor(value).width(1200).url() : "";
            const alt = value?.alt || "";
            return src
              ? `<figure class="about-image">
                   <img src="${src}" alt="${alt}" />
                 </figure>`
              : "";
          },
        },
      },
    })
  : "";
---

<Layout title="Katarzyna Lewińska — About">
  <div class="about-bio" set:html={bioHtml} />
</Layout>

<style lang="scss">
  :global(.about-bio) {
    width: 60%;
  }

  :global(.about-bio p) {
    margin: 0 0 1rem 0;
  }

  :global(.about-bio img) {
    width: 35%;
    height: auto;
    display: block;
  }

  @media (max-width: 768px) {
    :global(.about-bio) {
      width: 100%;
      padding-top: var(--lh);
    }
  }
</style>
